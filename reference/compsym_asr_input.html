<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate genetic values based on a compound symmetry model for GxE interaction - `AlphaSimR` input parameters — compsym_asr_input • FieldSimR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate genetic values based on a compound symmetry model for GxE interaction - `AlphaSimR` input parameters — compsym_asr_input"><meta name="description" content="Creates a list of input parameters for
`AlphaSimR` to simulate
genetic values in multiple environments for one or more traits based on a compound symmetry
model for genotype-by-environment (GxE) interaction.
This function utilises the ability of `AlphaSimR` to simulate correlated traits.
The wrapper function compsym_asr_input() is used to specify the input parameters required in `AlphaSimR`.
After simulating the genetic values, the wrapper function compsym_asr_output can be used to
generate a data frame with output values."><meta property="og:description" content="Creates a list of input parameters for
`AlphaSimR` to simulate
genetic values in multiple environments for one or more traits based on a compound symmetry
model for genotype-by-environment (GxE) interaction.
This function utilises the ability of `AlphaSimR` to simulate correlated traits.
The wrapper function compsym_asr_input() is used to specify the input parameters required in `AlphaSimR`.
After simulating the genetic values, the wrapper function compsym_asr_output can be used to
generate a data frame with output values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FieldSimR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/compound_symmetry_GxE_demo.html">Simulation of genetic values based on a compound symmetry model for genotype-by-environment (GxE) interaction</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_variation_demo.html">Simulation of plot errors and phenotypes in a plant breeding field trial</a></li>
    <li><a class="dropdown-item" href="../articles/unstructured_GxE_demo.html">Simulation of genetic values based on an unstructured model for genotype-by-environment (GxE) interaction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/crWerner/fieldsimr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate genetic values based on a compound symmetry model for GxE interaction - `AlphaSimR` input parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/crWerner/fieldsimr/blob/main/R/compound_symmetry_gxe.R" class="external-link"><code>R/compound_symmetry_gxe.R</code></a></small>
      <div class="d-none name"><code>compsym_asr_input.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a list of input parameters for
<a href="https://CRAN.R-project.org/package=AlphaSimR" class="external-link">`AlphaSimR`</a> to simulate
genetic values in multiple environments for one or more traits based on a compound symmetry
model for genotype-by-environment (GxE) interaction. <br>
This function utilises the ability of `AlphaSimR` to simulate correlated traits.
The wrapper function <code>compsym_asr_input()</code> is used to specify the input parameters required in `AlphaSimR`.
After simulating the genetic values, the wrapper function <a href="compsym_asr_output.html">compsym_asr_output</a> can be used to
generate a data frame with output values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compsym_asr_input</span><span class="op">(</span></span>
<span>  ntraits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nenvs <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  var <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prop.main <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  corA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  meanDD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varDD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prop.mainDD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corDD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  relAA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prop.mainAA <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corAA <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ntraits">ntraits<a class="anchor" aria-label="anchor" href="#arg-ntraits"></a></dt>
<dd><p>Number of traits to be simulated.</p></dd>


<dt id="arg-nenvs">nenvs<a class="anchor" aria-label="anchor" href="#arg-nenvs"></a></dt>
<dd><p>Number of environments to be simulated (minimum of two).</p></dd>


<dt id="arg-mean">mean<a class="anchor" aria-label="anchor" href="#arg-mean"></a></dt>
<dd><p>A vector of mean genetic values for each environment-within-trait combination.
If only one value is specified, all combinations will be assigned the same mean.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>A vector of genetic variances for each trait. <br><strong>Note:</strong> When <code>useVarA = TRUE</code> is specified in `AlphaSimR` (default), the values in
<code>var</code> represent the additive genetic variances, otherwise they represent the
total (additive + non-additive) genetic variances.</p></dd>


<dt id="arg-prop-main">prop.main<a class="anchor" aria-label="anchor" href="#arg-prop-main"></a></dt>
<dd><p>A vector defining the proportion of main effect variance for each trait.
If only one value is specified, all traits will be assigned the same proportion. <br><strong>Note:</strong> <code>0 &lt; prop.main &lt; 1</code>.</p></dd>


<dt id="arg-cora">corA<a class="anchor" aria-label="anchor" href="#arg-cora"></a></dt>
<dd><p>A matrix of additive genetic correlations between traits. By default, a diagonal
matrix is constructed.</p></dd>


<dt id="arg-meandd">meanDD<a class="anchor" aria-label="anchor" href="#arg-meandd"></a></dt>
<dd><p>A vector of mean dominance degrees for each environment-within-trait combination
(similar to <code>mean</code>). If only one value is specified, all combinations will be assigned
the same mean. By default, <code>meanDD = NULL</code> and dominance is not simulated.</p></dd>


<dt id="arg-vardd">varDD<a class="anchor" aria-label="anchor" href="#arg-vardd"></a></dt>
<dd><p>A vector of dominance degree variances for each trait.</p></dd>


<dt id="arg-prop-maindd">prop.mainDD<a class="anchor" aria-label="anchor" href="#arg-prop-maindd"></a></dt>
<dd><p>A vector defining the proportion of dominance degree main effect
variance for each trait (similar to <code>prop.main</code>).
If only one value is specified, all traits will be assigned the same proportion. <br><strong>Note:</strong> <code>0 &lt; prop.mainDD &lt; 1</code>.</p></dd>


<dt id="arg-cordd">corDD<a class="anchor" aria-label="anchor" href="#arg-cordd"></a></dt>
<dd><p>A matrix of dominance degree correlations between traits (similar
to <code>corA</code>). If not specified and dominance is simulated, a diagonal matrix is constructed.</p></dd>


<dt id="arg-relaa">relAA<a class="anchor" aria-label="anchor" href="#arg-relaa"></a></dt>
<dd><p>A vector defining the relative magnitude of additive-by-additive (epistatic) variance
to additive genetic variance for each trait, that is in a diploid organism with
allele frequency of 0.5.
If only one value is specified, all traits will be assigned the same relative magnitude.</p></dd>


<dt id="arg-prop-mainaa">prop.mainAA<a class="anchor" aria-label="anchor" href="#arg-prop-mainaa"></a></dt>
<dd><p>A vector defining the proportion of epistatic main effect variance for each
trait (similar to <code>prop.main</code>). If only one value is specified, all traits will be assigned the
same proportion. <br><strong>Note:</strong> <code>0 &lt; prop.mainAA &lt; 1</code>.</p></dd>


<dt id="arg-coraa">corAA<a class="anchor" aria-label="anchor" href="#arg-coraa"></a></dt>
<dd><p>A matrix of epistatic correlations between traits (similar to
<code>corA</code>). If not specified and epistasis is simulated, a diagonal matrix is constructed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with input parameters for `AlphaSimR`, which are used to simulate
  correlated genetic values based on a compound symmetry model for GxE interaction.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The compound symmetry model assumes the same genetic variance for each environment
and the same genetic covariance between each pair of environments. New functionality
is being implemented which relaxes the former assumption
(also see <a href="unstr_asr_output.html">unstr_asr_output</a>).</p>
<p><strong>Note:</strong> `AlphaSimR` can simulate different biological effects (see:
<a href="https://gaynorr.github.io/AlphaSimR/reference/SimParam.html" class="external-link">SimParam</a>).</p><ul><li><p>For additive traits use <code>addTraitA()</code>.</p></li>
<li><p>For additive + dominance traits use <code>addTraitAD()</code>.</p></li>
<li><p>For additive + epistatic traits use <code>addTraitAE()</code>.</p></li>
<li><p>For additive + dominance + epistatic traits use <code>addTraitADE()</code>.</p></li>
</ul><p>Check the <code>useVarA</code> argument of these functions when simulating non-additive traits.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate genetic values with 'AlphaSimR' for two additive + dominance traits</span></span></span>
<span class="r-in"><span><span class="co"># in two environments based on a compound symmetry model.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. Define the genetic architecture of the simulated traits.</span></span></span>
<span class="r-in"><span><span class="co"># Mean genetic values and mean dominance degrees.</span></span></span>
<span class="r-in"><span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.9</span>, <span class="fl">5.4</span>, <span class="fl">235.2</span>, <span class="fl">228.5</span><span class="op">)</span> <span class="co"># Trait 1 x 2 environments, Trait 2 x 2 environments</span></span></span>
<span class="r-in"><span><span class="va">meanDD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Trait 1 and 2, same value for both environments</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additive genetic variances and dominance degree variances.</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">13</span><span class="op">)</span> <span class="co"># Different values for Traits 1 and 2</span></span></span>
<span class="r-in"><span><span class="va">varDD</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Same value for Traits 1 and 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Proportion of additive and dominance degree main effect variances.</span></span></span>
<span class="r-in"><span><span class="va">prop.main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span> <span class="co"># Different values for Traits 1 and 2</span></span></span>
<span class="r-in"><span><span class="va">prop.mainDD</span> <span class="op">&lt;-</span> <span class="fl">0.4</span> <span class="co"># Same value for Traits 1 and 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additive and dominance degree correlations between the two simulated traits.</span></span></span>
<span class="r-in"><span><span class="va">corA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.5</span>, <span class="fl">1.0</span></span></span>
<span class="r-in"><span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corDD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Assuming independence</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input_asr</span> <span class="op">&lt;-</span> <span class="fu">compsym_asr_input</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ntraits <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  nenvs <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  mean <span class="op">=</span> <span class="va">mean</span>,</span></span>
<span class="r-in"><span>  var <span class="op">=</span> <span class="va">var</span>,</span></span>
<span class="r-in"><span>  prop.main <span class="op">=</span> <span class="va">prop.main</span>,</span></span>
<span class="r-in"><span>  corA <span class="op">=</span> <span class="va">corA</span>,</span></span>
<span class="r-in"><span>  meanDD <span class="op">=</span> <span class="va">meanDD</span>,</span></span>
<span class="r-in"><span>  varDD <span class="op">=</span> <span class="va">varDD</span>,</span></span>
<span class="r-in"><span>  prop.mainDD <span class="op">=</span> <span class="va">prop.mainDD</span>,</span></span>
<span class="r-in"><span>  corDD <span class="op">=</span> <span class="va">corDD</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian Werner, Daniel Tolhurst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

