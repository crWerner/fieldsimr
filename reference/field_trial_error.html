<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate plot errors in plant breeding field trials — field_trial_error • FieldSimR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate plot errors in plant breeding field trials — field_trial_error"><meta name="description" content="Creates a data frame of simulated plot errors in multi-environment field trials for one or
more traits. The plot errors capture spatial trend, random error (noise), and extraneous variation.
Spatial trend is simulated using bivariate interpolation or a separable first-order
autoregressive (AR1) process. Random error is simulated using an independent process. Extraneous
variation is simulated using random or zig-zag ordering between neighbouring columns and/or rows.
The three error components are combined at a user-defined ratio.
Correlated plot errors can be simulated between traits by setting different correlation structures
for each error component. A separable structure is assumed between traits and plots within environments,
but different error variances can be specified for each environment-within-trait combination."><meta property="og:description" content="Creates a data frame of simulated plot errors in multi-environment field trials for one or
more traits. The plot errors capture spatial trend, random error (noise), and extraneous variation.
Spatial trend is simulated using bivariate interpolation or a separable first-order
autoregressive (AR1) process. Random error is simulated using an independent process. Extraneous
variation is simulated using random or zig-zag ordering between neighbouring columns and/or rows.
The three error components are combined at a user-defined ratio.
Correlated plot errors can be simulated between traits by setting different correlation structures
for each error component. A separable structure is assumed between traits and plots within environments,
but different error variances can be specified for each environment-within-trait combination."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FieldSimR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/compound_symmetry_GxE_demo.html">Simulation of genetic values based on a compound symmetry model for genotype-by-environment (GxE) interaction</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_variation_demo.html">Simulation of plot errors and phenotypes in a plant breeding field trial</a></li>
    <li><a class="dropdown-item" href="../articles/unstructured_GxE_demo.html">Simulation of genetic values based on an unstructured model for genotype-by-environment (GxE) interaction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/crWerner/fieldsimr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate plot errors in plant breeding field trials</h1>
      <small class="dont-index">Source: <a href="https://github.com/crWerner/fieldsimr/blob/main/R/field_trial_error.R" class="external-link"><code>R/field_trial_error.R</code></a></small>
      <div class="d-none name"><code>field_trial_error.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a data frame of simulated plot errors in multi-environment field trials for one or
more traits. The plot errors capture spatial trend, random error (noise), and extraneous variation.
Spatial trend is simulated using bivariate interpolation or a separable first-order
autoregressive (AR1) process. Random error is simulated using an independent process. Extraneous
variation is simulated using random or zig-zag ordering between neighbouring columns and/or rows.
The three error components are combined at a user-defined ratio. <br>
Correlated plot errors can be simulated between traits by setting different correlation structures
for each error component. A separable structure is assumed between traits and plots within environments,
but different error variances can be specified for each environment-within-trait combination.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">field_trial_error</span><span class="op">(</span></span>
<span>  ntraits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nenvs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nblocks <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  block.dir <span class="op">=</span> <span class="st">"col"</span>,</span>
<span>  ncols <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nrows <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  varR <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ScorR <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RcorR <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  EcorR <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatial.model <span class="op">=</span> <span class="st">"Bivariate"</span>,</span>
<span>  complexity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot.length <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  plot.width <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  col.cor <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  row.cor <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  prop.spatial <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  ext.ord <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  ext.dir <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>  prop.ext <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  return.effects <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ntraits">ntraits<a class="anchor" aria-label="anchor" href="#arg-ntraits"></a></dt>
<dd><p>Number of traits to be simulated.</p></dd>


<dt id="arg-nenvs">nenvs<a class="anchor" aria-label="anchor" href="#arg-nenvs"></a></dt>
<dd><p>Number of environments to be simulated.</p></dd>


<dt id="arg-nblocks">nblocks<a class="anchor" aria-label="anchor" href="#arg-nblocks"></a></dt>
<dd><p>A vector defining the number of blocks in each environment.
If only one value is specified, all environments will be assigned the same number.</p></dd>


<dt id="arg-block-dir">block.dir<a class="anchor" aria-label="anchor" href="#arg-block-dir"></a></dt>
<dd><p>A vector defining the block direction in each environment. Use
'col' for side-by-side (default), 'row' for above-and-below, or
NA if only one block is simulated. If only one value is specified, all environments
will be assigned the same block direction.</p></dd>


<dt id="arg-ncols">ncols<a class="anchor" aria-label="anchor" href="#arg-ncols"></a></dt>
<dd><p>A vector defining the number of columns in each environment. If only one
value is specified, all environments will be assigned the same number.</p></dd>


<dt id="arg-nrows">nrows<a class="anchor" aria-label="anchor" href="#arg-nrows"></a></dt>
<dd><p>A vector defining the number of rows in each environment. If only one
value is specified, all environments will be assigned the same number.</p></dd>


<dt id="arg-varr">varR<a class="anchor" aria-label="anchor" href="#arg-varr"></a></dt>
<dd><p>A vector of error variances for each environment-within-trait combination. If only
one value is specified, all combinations will be assigned the same error variance.</p></dd>


<dt id="arg-scorr">ScorR<a class="anchor" aria-label="anchor" href="#arg-scorr"></a></dt>
<dd><p>A matrix of spatial error correlations between traits. If not specified and
spatial trend is simulated, a diagonal matrix is constructed.</p></dd>


<dt id="arg-rcorr">RcorR<a class="anchor" aria-label="anchor" href="#arg-rcorr"></a></dt>
<dd><p>A matrix of random error correlations between traits. If not specified and
random error is simulated, a diagonal matrix is constructed.</p></dd>


<dt id="arg-ecorr">EcorR<a class="anchor" aria-label="anchor" href="#arg-ecorr"></a></dt>
<dd><p>A matrix of extraneous error correlations between traits. If not specified and
extraneous variation is simulated, a diagonal matrix is constructed. <br><strong>Note:</strong> the same correlation between traits is used for the column and row errors.
Currently only implemented when <code>ext.ord = "random"</code>.</p></dd>


<dt id="arg-spatial-model">spatial.model<a class="anchor" aria-label="anchor" href="#arg-spatial-model"></a></dt>
<dd><p>A character string defining the model used to simulate spatial trend.
Use 'Bivariate' for bivariate interpolation (default) or 'AR1' for a separable first-order
autoregressive process. Bivariate interpolation is implemented with the <code>interp</code>
function of the R package <a href="https://CRAN.R-project.org/package=interp" class="external-link">`interp`</a>.</p></dd>


<dt id="arg-complexity">complexity<a class="anchor" aria-label="anchor" href="#arg-complexity"></a></dt>
<dd><p>A vector defining the complexity of the simulated spatial trend in each
environment when <code>spatial.model = "Bivariate"</code>. If only one value is specified,
all environments will be assigned the same complexity.
If not specified and <code>spatial.model = "Bivariate"</code>, the complexity is set to half the maximum
number of columns and rows in each environment.</p></dd>


<dt id="arg-plot-length">plot.length<a class="anchor" aria-label="anchor" href="#arg-plot-length"></a></dt>
<dd><p>A vector of plot lengths for each environment (column direction). If only one value is specified,
all environments will be assigned the same plot length. Only required when <code>spatial.model = "Bivariate"</code>.</p></dd>


<dt id="arg-plot-width">plot.width<a class="anchor" aria-label="anchor" href="#arg-plot-width"></a></dt>
<dd><p>A vector of plot widths for each environment (row direction). If only one value is specified,
all environments will be assigned the same plot width. Only required when <code>spatial.model = "Bivariate"</code>.</p></dd>


<dt id="arg-col-cor">col.cor<a class="anchor" aria-label="anchor" href="#arg-col-cor"></a></dt>
<dd><p>A vector of column autocorrelations for each environment.
If only one value is specified, all environments will be assigned the same column autocorrelation.
Only required when <code>spatial.model = "AR1"</code>.</p></dd>


<dt id="arg-row-cor">row.cor<a class="anchor" aria-label="anchor" href="#arg-row-cor"></a></dt>
<dd><p>A vector of row autocorrelations for each environment.
If only one value is specified, all environments will be assigned the same row
autocorrelation. Only required when <code>spatial.model = "AR1"</code>.</p></dd>


<dt id="arg-prop-spatial">prop.spatial<a class="anchor" aria-label="anchor" href="#arg-prop-spatial"></a></dt>
<dd><p>A vector defining the proportion of spatial trend for each environment-within-trait
combination. If only one value is specified, all combinations will be assigned the proportion.</p></dd>


<dt id="arg-ext-ord">ext.ord<a class="anchor" aria-label="anchor" href="#arg-ext-ord"></a></dt>
<dd><p>A character string defining the method used to simulate extraneous variation.
Use 'random' (default) for random variation between neighbouring columns and/or rows or
'zig-zag' for alternating positive and negative values.</p></dd>


<dt id="arg-ext-dir">ext.dir<a class="anchor" aria-label="anchor" href="#arg-ext-dir"></a></dt>
<dd><p>A vector defining the direction of extraneous variation for each environment.
Use 'row' (default) for row variation, 'col' for column variation, 'both' for variation in both directions,
or NA if no extraneous variation is simulated. When <code>ext.dir = "both"</code>, half the variance is assigned to the columns and
half is assigned to the rows. If only one value is specified, all environments will be
assigned the same direction.</p></dd>


<dt id="arg-prop-ext">prop.ext<a class="anchor" aria-label="anchor" href="#arg-prop-ext"></a></dt>
<dd><p>A vector defining the proportion of extraneous variation for each environment-within-trait
combination. If only one value is specified, all combinations will be assigned the same proportion.</p></dd>


<dt id="arg-return-effects">return.effects<a class="anchor" aria-label="anchor" href="#arg-return-effects"></a></dt>
<dd><p>When <code>TRUE</code> (default is <code>FALSE</code>), a list is returned with additional entries
containing the spatial, random, and extraneous error terms for each trait.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns 'env', 'block', 'col', and 'row', followed by the
  simulated plot errors for each trait. When <code>return.effects = TRUE</code>, a list is returned with additional entries
  containing the spatial, random, and extraneous error terms for each trait.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate plot errors for two traits in two environments using an AR1 model</span></span></span>
<span class="r-in"><span><span class="co"># for spatial variation.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Error variances for the four environment-within-trait combinations.</span></span></span>
<span class="r-in"><span><span class="va">varR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span> <span class="co"># Trait 1 x 2 environments, Trait 2 x 2 environments</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial error correlations between the two simulated traits.</span></span></span>
<span class="r-in"><span><span class="va">ScorR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1.0</span>, <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.2</span>, <span class="fl">1.0</span></span></span>
<span class="r-in"><span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">error_ls</span> <span class="op">&lt;-</span> <span class="fu">field_trial_error</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ntraits <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  nenvs <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  nblocks <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  block.dir <span class="op">=</span> <span class="st">"row"</span>,</span></span>
<span class="r-in"><span>  ncols <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  nrows <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  varR <span class="op">=</span> <span class="va">varR</span>,</span></span>
<span class="r-in"><span>  ScorR <span class="op">=</span> <span class="va">ScorR</span>,</span></span>
<span class="r-in"><span>  spatial.model <span class="op">=</span> <span class="st">"AR1"</span>,</span></span>
<span class="r-in"><span>  col.cor <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  row.cor <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>  prop.spatial <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>  ext.ord <span class="op">=</span> <span class="st">"zig-zag"</span>,</span></span>
<span class="r-in"><span>  ext.dir <span class="op">=</span> <span class="st">"row"</span>,</span></span>
<span class="r-in"><span>  prop.ext <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  return.effects <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian Werner, Daniel Tolhurst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

